<title>schwarzkasten.</title>
<meta charset="UTF-8">
<link href='http://fonts.googleapis.com/css?family=Titillium+Web|Open+Sans|Roboto&subset=latin,latin-ext' rel='stylesheet' type='text/css'>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/2.0.0/jquery.min.js"></script>
<div id="playercube">
    <player id="play1" class="loading"></player>
</div>

<div id="namecon">
    <h1 class="big">BLACKBOX</h1>
</div>

<div id="particles">
</div>

<div id="field" >
    0.9 dev 
</div>
<focus></focus>



<div id="ui">
    money: <span id="money"></span>
</div>

<div id="mainwrap"></div>
<style>
     h1.big:before {
    position: absolute;
    content: '';
    width: 50px;
    height: 50px;
    ackground:#48f;
    margin-top: 10px;
    margin-left: 90px;    
        -webkit-animation:growup 1s ;
        -webkit-animation-fill-mode: forwards;
        -webkit-animation-delay:1s;
        }
    h1.big {
        color:transparent !important;
       margin-top:50px;
       -webkit-animation:slideupa .8s ;
        -webkit-animation-fill-mode: forwards; 
        -webkit-animation-delay:1.5s;
    }
    @-webkit-keyframes growup {
        0%{margin-left:90px;background:#48f;}
        60%{margin-left:0px; width:235px; height: 50px;}
        100%{height: 0px;width:235px;margin-left:0px;background: #444;}
    }
     @-webkit-keyframes slideupa {
        0%{bottom:0px;color:transparent;}
        100%{bottom:40px; color: #444;}
    }
   
    
    #ui {
        position: fixed;
        bottom: 0;
        margin:20px;
    }
    
    body {margin:0;padding:0;}
#namecon h1.big {
    font-family: 'Titillium Web', sans-serif;
    font-weight: 400;
    text-transform: uppercase;
    text-align: center;
    /*font-size: 10vw;*/
    font-size:50px;
    margin-left:calc(50% - 120px);
    position: fixed;
   bottom:0px;
    color:#222;
    /*margin-top:200px;*/
    
}
    #mainwrap {
        z-index: -1;
        position: fixed;
        top:0;
        left:0;
        right: 0;
        bottom: 0;
        background:#f1f1f1;
    }
    #field {
        border:1px solid #444;
        position: fixed;
        top:0;
        padding:-1px;
        left:0;
    }
    /*actual code*/
    player, portal, laser, checkpoint, money, key, lock, focus, p-portal,p-laser ,wall {
        position: fixed;
    }
    player {
        width: 50px;
        height:50px;
        background:#48F;
        transition:all .1s linear;
        top:1;
        left:1;
    }
    player.ms {
       /* margin-left:calc(50% - 25px);*/
    }
     player.ms.loading {
       -webkit-animation:transiter 1s  linear;
    }
    @-webkit-keyframes transiter {
        0% {border-radius:0px;-webkit-transform:rotate(0deg);}
        50% {border-radius:25px;-webkit-transform:rotate(180deg);}
        100% {border-radius:0px;-webkit-transform:rotate(360deg);}
    }
    wall {
        background: #666;
        width: 50px;
        height: 4px;   
    }
    wall.top    {  }
    wall.left   { transform: rotate(90deg); margin-top: 23px; margin-left: -23px; }
    wall.right  { transform: rotate(90deg); margin-top: 23px; margin-left:  23px; }
    wall.bottom {  margin-top: 46px; }
    
    
    portal {
        position: fixed;
        background:#48f;
        width: 42px;
        height: 4px;
        margin-top:0px;
        z-index: 2;
    }
    portal.on {
        background: #f84;
        width:50px;
        transition:.4s;
    }
    portal.active {
        background:blue;
    }
    portal.top    { margin: -4px 4px; }
    portal.left   { margin: 24px -16px;  transform: rotate(90deg); }
    portal.right  { margin: 24px 31px ;  transform: rotate(90deg); }
    portal.bottom { margin: 49px 7px; }
    
    portal.top.on    { margin: -4px 0px; }
    portal.left.on   { margin: 24px -16px;  /*NOT IMPLEMENTED*/}
    portal.right.on  { margin: 23px 27px;  }
    portal.bottom.on { margin: 49px 7px; /*NOT IMPLEMENTED*/}
    p-portal {
        background: #48F;
        width: 15px;
        height: 15px;
        margin: 16px;
        z-index: 0;
    }
    p-portal.top.on    {-webkit-animation:portal-poss-top    1s infinite;}
    p-portal.bottom.on {-webkit-animation:portal-poss-bottom 1s infinite;}
    p-portal.left.on   {-webkit-animation:portal-poss-left   1s infinite; margin:19px;}
    p-portal.right.on  {-webkit-animation:portal-poss-right  1s infinite; margin:19px;}
    
    @-webkit-keyframes portal-poss-top{
        0%   {opacity: .4; margin-top:0px; }
        80% {opacity:.8; margin-top:-30px;}
        100% {opacity:0;margin-top:-30px}
    }
    @-webkit-keyframes portal-poss-bottom {
        0%   {opacity: .4; margin-top:0px; }
        80% {opacity:.8; margin-top:30px;}
        100% {opacity:0;margin-top:30px}
    }
    @-webkit-keyframes portal-poss-left {
        0%   {opacity: .4; margin-right:0px; }
        80% {opacity:.8; margin-left:-30px;}
        100% {opacity:0;margin-left:-30px}
    }
    @-webkit-keyframes portal-poss-right {
        0%   {opacity: .4; margin-left:40px; }
        80% {opacity:.8;margin-left:65px;}
        100% {opacity:0;margin-left:65px}
    }
    
    /*LASERS*/   
    laser {
        background: #F44;
        width: 35px;
        height: 5px;
    }
    laser.top    { margin: -5px 7px; }
    laser.left   { margin: 23px -19px;  transform: rotate(90deg); }
    laser.right  { margin: 23px 35px ;  transform: rotate(90deg); }
    laser.bottom { margin: 50px 7px; }
    p-laser {
        background: blue;
        margin:5px 25px;
        width: 1px; 
        transition: .3s;
    }
    p-laser.on {
        background: cyan;
        width: 25px;
        margin:5px 12px;
    }
    
    /*checkpoint*/
    checkpoint, placed-mine /deep/ #Mine {
         width: 20px;
        height: 20px;
        margin:13px;
        border-radius: 50%;
        background:transparent;
        border:2px solid #4CAF50;
        transition: background .4s;
        box-shadow: 0px 0px 1px #ddd;
        
    }
    checkpoint.on {
        background: #4CAF50;   
    }
    
    /*money*/
    money {
         width: 10px;
        height: 10px;
        border-radius: 10px;
        background: #f84 !important;
        margin:20px;
        transition: border-radius .4s, margin .4s, width .4s, height .4s, opacity 1s;
    }
    money.on {
        border-radius: 0px;
        margin:0px;
        width: 50px;
        height: 50px;
        opacity:0;
    }
    
    /*key & lock*/
    key,lock {
        width: 10px;
        height: 10px;
        margin: 20px;
        background: #f84;
    }
    lock, lock.on.open {
        transform: rotate(45deg);
        border:3px solid #DDD;
        margin:17px;
        transition:all .4s;
    }
    lock.on:not(.open) {
       transform: rotate(0deg);
        width: 20px;
        height: 20px;
         margin: 12px;
    }
    .hovel {
        -webkit-animation:zfade 1s;
        opacity:0;   
    }
    @-webkit-keyframes  zfade {
        0% {opacity:1;}
        100% {margin:-15px;width:80px;height:80px;opacity:0;}
    }
    
    /*U-BLOCK*/
    u-block.on /deep/ #uBlock {
                    opacity:.4;
         transition:opacity .4s;
                }
    u-block.open /deep/ #uBlock  {
        opacity:.1;
         transition:opacity .4s;
    }
    
    /*FOCUS*/ 
     focus {
        border: 3px #666 dashed;
        position: fixed;
        height: 18px;
        width: 18px;
        border-radius: 50%;
        margin: 12px;
        margin-top: 13px;
        -webkit-animation: forogjal 4s linear infinite;
    }
    @-webkit-keyframes forogjal {
	0%{transform: rotate(0deg);}
	100%{transform: rotate(360deg);}
	}
    
    placed-mine.on /deep/ #Mine {
        -webkit-animation:defuses 6s ease-in;
        -webkit-animation-fill-mode: forwards; 
    }
    @-webkit-keyframes defuses {
        0% {transform:rotate(0deg);}
        100% {transform:rotate(3600deg);}
    }
</style>

<script>
map=[];         //keys
move = {};      //anything related to moving
ui = {};
rules = {};     //triggered upon arriving on a block
    
move.right =   function(a) {  player.posy++;  }   
move.left =    function(a) {  player.posy--;  }  
move.forward = function(a) {  player.posx--;  }  
move.back =    function(a) {  player.posx++;  }  
move.to  =     function(x,y) { 
                        player.posx=x;
                        player.posy=y; 
    move.update();
                }

player = {
    posx:0,
    posy:0,
    cpointx:0, //checkpoint
    cpointy:0
};    
player.checkpoint = function() {
    player.posx=player.cpointx;
    player.posy=player.cpointy;
    move.update();
}
    

rules.block = function() {
      player.posx=player.befx;
      player.posy=player.befy;
}
rules.key = function(color) {
     $('#key'+player.posy+player.posx).addClass("hovel");   
     console.log(color);
     $('.lock'+color.slice(1,this.length)).addClass("on");
    
    //register that you have collected this
        if (coll.keys[color]===undefined) {coll.keys[color]=1;}
        else coll.keys[color]++;
    move.prelude=function(){};          
    grid[player.posx][player.posy]="rules.nothing()";
}
rules.nothing = function() {
    return false;
}
rules.laser = function() {
    return false;
}
rules.money= function() {
    coll.money++;
    $('#money'+player.posy+player.posx).addClass('on');
    grid[player.posx][player.posy]="rules.nothing()";
    
}
rules.checkpoint = function() {
    $('#play1').addClass('ms');
    setTimeout(function(){
        $('#play1').removeClass('ms');
    },1000)
    $('checkpoint').removeClass('on');
    $('#cp'+player.posy+player.posx).addClass("on");  
    player.cpointx=player.posx;
    player.cpointy=player.posy;
}
rules.fire = function() {
    player.checkpoint();
}
rules.door = function(color) {
    if (coll.keys[color]>0) {
        coll.keys[color]--;
        if( coll.keys[color]==0) {
           setTimeout(function(){
               move.prelude=function(){ $('.lock'+color.slice(1,this.length)).removeClass("on");}
           },10);
        } 
        $('u-block[x="'+player.posy+'"][y="'+player.posx+'"]').addClass("open");           
        grid[player.posx][player.posy]="nothing()";//do not operate as a door anymore
    }
    else {
        player.posx=player.befx;
        player.posy=player.befy;
    }
}
rules.wall = function(dirfrom) {
    dparty_x=NaN; dparty_y=NaN; 
    if (dirfrom=="top") { dparty_x=-1;}     //TODO TRANSFORM INTO NICE FUNCTION
    if (dirfrom=="bottom") { dparty_x=1;}
    if (dirfrom=="right") { dparty_y=1;}
    if (dirfrom=="left") { dparty_y=-1;}
    if (( player.posx+dparty_x==player.befx)|| ( player.posy+dparty_y==player.befy) ) {
         player.posx=player.befx;
         player.posy=player.befy;
    }
}
rules.time = {} ; //rules that require Timing

    
rules.pre = {}; //rules that shall be activated before the 

function setRule(what,where,specials) {
    for (i=0;i<where.length;i++) //BASIC FUNCTIONS
    {   
       // console.log(where[i][0],where[i][1]);
        if ( grid[where[i][0]][where[i][1]]===undefined) { grid[where[i][0]][where[i][1]]='';}
        grid[where[i][0]][where[i][1]]+='rules.'+what+';'; //adding JS function
        ycord=where[i][0];
        xcord=where[i][1];
        if (what=="block()") 
        {
            field.innerHTML+='<u-block x='+(where[i][1])+' y='+(where[i][0])+'> </u-block>';
        }
        if (what=="fire()") {
            field.innerHTML+='<u-block x='+(where[i][1])+' y='+(where[i][0])+' color="#f44"> </u-block>';
        }
        if (what.search("key")>=0)
        {
            field.innerHTML+='<key style="left:'+xcord*50+';top:'+ycord*50+';background:'+specials+';" id="key'+xcord+''+ycord+'" > </key>';
        }
        if (what.search("door")>=0)
        {
             b=specials.slice(1,specials.length);
             field.innerHTML+='<u-block x='+(where[i][1])+' y='+(where[i][0])
                +' color="'+b+'" class="lock'+b+'"> </u-block>';
            
             field.innerHTML+='<lock style="left:'+xcord*50+';top:'+ycord*50+';background:'+specials
                +';" id="lock'+xcord+''+ycord+'" class="lock'+b+'"> </lock>';
            //var coll.keys[b];
            //coll.keys[b]++;
        }
        if (what.search("money")>=0) //tba: more money
        {
             field.innerHTML+='<money style="left:'+xcord*50+';top:'+ycord*50
                 +'" id="money'+(where[i][1])+(where[i][0])+'"> </money>';
        }
        if (what.search("checkpoint")>=0) {
            field.innerHTML+='<checkpoint style="left:'+xcord*50+';top:'+ycord*50
                +'" id="cp'+(where[i][1])+(where[i][0])+'"> </money>';
        }
        if (what.search("mine")>=0) {
            field.innerHTML+='<placed-mine x='+(where[i][1])+' y='+(where[i][0])+'></placed-mine>';
        }
        if (what.search("wall")>=0) {
             field.innerHTML+='<wall style="left:'+xcord*50+';top:'+ycord*50+'" class="'+specials+'"></wall>';
        }
    }//FOR 
    
    if (what.search("laser")>=0)   {
            elements.laser.count++;
            console.info('LASERs',where[0][0],where[0][1]);
            console.info('LASERf',where[1][0],where[1][1]);
            
        if (Math.abs(where[0][0]-where[1][0])>0) {//if Ycord is different.
                //Y cord
            field.innerHTML+='<laser style="left:'+where[0][1]*50+';top:'+where[0][0]*50
                +'" class="bottom" id="laser'+elements.laser.count+'"></laser>'; //first-top
            field.innerHTML+='<laser style="left:'+where[1][1]*50+';top:'+where[1][0]*50
                +'" class="top"></laser>'; //sec-bottom
    
    particles.innerHTML+='<p-laser style="left:'+where[0][1]*50+';top:'+(where[0][0]+1)*50+'; height:'+(Math.abs((where[1][0]-where[1][1])*50)-10)+'" id="plaser'+elements.laser.count+'"></p-laser>';
            
            affected=[];              
            for (i=0;i<=Math.abs(where[1][0]-where[1][1]);i++) { //blocks that should kill you
                affected[affected.length]=[where[1][1],Math.abs(where[1][0]-i)];
            }  
                console.log(affected);
               // alert(Math.abs((where[1][0]-where[1][1])) +'\n'+ affected);
                
            elements.laser.register({
                id : elements.laser.count,
                loc : affected,
                is : false,
                on : specials[0],
                off:specials[1]
                        });
                
            }
            else if (Math.abs(where[0][1]-where[1][1])>0)
            {
                    //TODO 4 LATER..
            }
        }
    if (what.search("portal")>=0) {
        // in the first Array  the starting portal ID and ending.
        // specials: directions for the first, 2nd portal
        
        elements.portal.count++;
        
        field.innerHTML+='<portal style="left:'+where[0][1]*50+';top:'+where[0][0]*50
            +'" id="portal'+where[0][1]+where[0][0]+'" class="'+specials[0]+'"></portal>'; //first-top
        
         field.innerHTML+='<portal style="left:'+where[1][1]*50+';top:'+where[1][0]*50
            +'" id="portal'+where[1][1]+where[1][0]+'" class="'+specials[1]+'"></portal>'; //first-top
        
        particles.innerHTML+='<p-portal style="left:'+where[0][1]*50+';top:'+where[0][0]*50 //yes, the ID-s are swapped
            +';" class="'+specials[0]+'"id="pportal'+where[1][1]+where[1][0]+'"></portal>';
        
        particles.innerHTML+='<p-portal style="left:'+where[1][1]*50+';top:'+where[1][0]*50
            +';" class="'+specials[1]+'"id="pportal'+where[0][1]+where[0][0]+'"></portal>';
        
        
        console.log('hello');
        
        elements.portal.register({//register the first one
                id    :   elements.portal.count,
                from  :   [where[0][0],where[0][1]],
                to    :   [where[1][0],where[1][1]],
                fromDir : specials[0],
                toDir   : specials[1]
                        });
        elements.portal.count++;
        
        elements.portal.register({
                id    :   elements.portal.count,            
                from    :   [where[1][0],where[1][1]],
                to      :   [where[0][0],where[0][1]],                
                fromDir  : specials[1],
                toDir : specials[0]
                        });         
    }
}//fn

  
coll = {};
coll.keys={};
coll.money=0;

elements = {};
    
    //noooo there lasers...
elements.laser={};
elements.laser.count=0;
elements.laser.obj=[];
    
elements.portal={};
elements.portal.count=0;
elements.portal.obj=[];
    
elements.portal.register = function(portal) {
    elements.portal.obj[elements.portal.count]=portal;
}
hasPortalActionHappened=false;
    
elements.portal.check = function(portal) {
    //console.warn('PORTAL');
    //console.log(player.posx,portal.from[0],' - ',player.posy,portal.from[1], portal.fromDir);  
    party_x=0; party_y=0;
    
    if (portal.toDir=="top") { party_x=-1;}
    if (portal.toDir=="bottom") { party_x=1;}
    if (portal.toDir=="right") { party_y=1;}
    if (portal.toDir=="left") { party_y=-1;}
    
    if ((player.posx==portal.from[0])&&(player.posy==portal.from[1])) {//if you are on the right place
        if (  ((portal.fromDir=="top")    && (player.befx==portal.from[0]-1)) ||//and you came from the right direction
              ((portal.fromDir=="bottom") && (player.befx==portal.from[0]+1)) ||
              ((portal.fromDir=="right")&& (player.befy==portal.from[1]+1)) ||
              ((portal.fromDir=="left") && (player.befy==portal.from[1]-1)) ) 
        {
            
            //move to right location
            
           player.posx=portal.to[0]+party_x;
           player.posy=portal.to[1]+party_y; 
            hasPortalActionHappened=true;
            //console.log(move.to);
          console.info('Teleported to',portal.to[0],portal.to[1]);
        } 
    }
    
     $('#portal'+(player.posy-party_y)+''+(player.posx-party_x)).addClass('on');//if you are on the neccesary block
     $('#pportal'+(player.posy-party_y)+''+(player.posx-party_x)).addClass('on');
}
    
elements.laser.check = function(laser) 
    {
    // console.log(laser.loc,laser.id);
        if (laser.is)
            for ( i=0 ; i<laser.loc.length ; i++ ) //console.log(laser.loc[0][i]);
                if ( laser.loc[i][0]==player.posy ) 
                    for ( j=0 ; j<laser.loc.length ; j++ ) //console.info(laser.loc[1][j]);
                        if ( laser.loc[j][1]==player.posx )  player.checkpoint();
                
    }
    
elements.laser.register = function(laser)
    {
        elements.laser.obj[elements.laser.count]=laser;
        elements.laser.turnOn(laser);
    }
    
    
elements.laser.turnOn =function(laser) {
    $('#plaser'+laser.id).addClass('on');
    laser.is=true;
    //console.log(laser);
    elements.laser.check(laser);
    setTimeout(function(){
        elements.laser.turnOff(laser);
    },laser.on)
}
elements.laser.turnOff =function(laser) {
    $('#plaser'+laser.id).removeClass('on');
    laser.is=false;
    setTimeout(function(){
        elements.laser.turnOn(laser);
    },laser.off)
}  
    //end.
    
function check() {//DO NOT USE
    eval(grid[player.posx][player.posy]);
    move.update();
      
}
move.prelude = function() {}; //contains orders, that are excecuted upon movement
move.update= function () {
    play1.style.top=player.posx*50;
    play1.style.left=player.posy*50;
    
   // console.log('s');
    
} 

document.body.onkeydown = function (e) {
    map[e.which] = e.type == 'keydown';
   // console.log(map);
     if (typeof(grid[player.posx][player.posy])!="undefined") {
        if (grid[player.posx][player.posy].search("wall")>=0) {
            console.log('asdf');
        }
    }
    
    player.befx=player.posx;
    player.befy=player.posy;
    
            if (map[ 68 ])  move.right();
            else if (map[ 87 ])  move.forward(); 
            else if (map[ 65 ])  move.left();    
            else if (map[ 83 ])  move.back(); 
    
    //disable going out
    if (player.posy>level.width)  { player.posy=level.width;  move.update(); }
    if (player.posx>level.height) { player.posx=level.height; move.update(); }   
    if (player.posy<0) { player.posy=0; move.update(); }
    if (player.posx<0) { player.posx=0; move.update(); }
    
    $('portal,p-portal').removeClass('on');
    
    for (var k=1;k<=elements.portal.count;k++) {//check portals
        elements.portal.check(elements.portal.obj[k]);
    }
    for (var k=1;k<=elements.laser.count;k++) { //check lasers
        elements.laser.check(elements.laser.obj[k]);
    }
   
    if (!hasPortalActionHappened) {
        eval(grid[player.posx][player.posy]); }
    hasPortalActionHappened=false;
    
    
    move.update();
    //check(); /|\ moved here
    if (move.hasMoved()) move.prelude(); //ha mozgott a játékos csak akkor
    console.log(player.posx,player.posy);
    ui.update();
    
} 


move.hasMoved = function() {
    if ( (player.posy==player.befy) &&
         (player.posx==player.befx)  )
         return false;
  
    else{
        // console.info(player.posx+'-'+player.befy);
        return true;
        }
}


//MAIN FUNCTION
document.body.onkeyup = function(e) {
     map=[];
    //console.log(map +'E');
}
wh=window.innerHeight;
ww=window.innerWidth;
level ={};
level.set = function(e) {
    
}
grid=[];
level.setField= function(w,h) {
    field.style.width=(w+2)*50;
    field.style.height=(h+2)*50;
    level.width=w+1;
    level.height=h+1;
    for (i=0;i<w;i++) 
    {
        grid[i]=[];
    }
}
level.setField(15,7); 
    
ui.update =function() {
    money.innerHTML=coll.money;
}
  a='';
setTimeout(function(){
document.oncontextmenu = function() {return false;};

  $('#field *, #playercube player').mousedown(function(e){ 
    if( e.button == 2 ) { 
      //alert('Right mouse button!'+this);
      console.log(this); 
        a=this;
      dbga="<table><tr><td>ID:</td><td>" + a.getAttribute('id') 
            + "</td></tr><tr><td>name:</td><td>" +a.tagName
             + "</td></tr><tr><td>class:</td><td> "+a.getAttribute('class') 
             +"</td></tr><tr><td>style:</td><td> " + a.getAttribute('style');    
     if (a.tagName=="U-BLOCK") {
         dbga+="</td></tr><tr><td>location:</td><td>"+ 
             a.getAttribute('x') +"-" +
             a.getAttribute('y') +
             "</td></tr><tr><td>event:</td><td>" +grid[a.getAttribute('y')][a.getAttribute('x')];
     }   
        dbg.innerHTML=dbga+"</table>";
      return false; 
    } 
    return true; 
  }); 
    },500);

setRule('laser(2)',[[3,4],[7,4]],[1000,3000]);
setRule('laser(4)',[[3,8],[6,8]],[1200,800]);
setRule('portal(4)',[[3,7],[8,10]],["top","right"]);
    
setRule('block()',[[3,4],[7,4],[3,6],[3,7],[6,8],[6,10],[7,13],[7,8],[8,8],[7,10],[8,10],[3,8]]);
    
setRule('key("#62c")',[[1,6],[3,10]],'#62c');
setRule('key("#f44")',[[7,5]],'#F44');
setRule('door("#62c")',[[6,9],[7,12]],'#62c');
setRule('door("#f44")',[[4,12]],'#f44');
setRule('money()',[[8,9]]);
setRule('fire()',[[7,14]]);
setRule('checkpoint()',[[2,12],[1,3]]);
setRule('mine()',[[5,15]]);
setRule('wall("top")',[[4,13],[4,14]],"top");
setRule('wall("right")',[[4,14]],"right");

</script>
<div id="dbg" style="">Debug window</div>
<style>
#dbg {
    position:fixed;
    right:0px;
    min-width:200px;
    word-break: break-word;
    font-family:monospace;
}
</style>
<polymer-element name="u-block" attributes="x y color portal color" noscript>
           <template>
               <div id="uBlock"></div>                  
               <style>
               #uBlock {
                    position: fixed;
                    width: 50px;
                    height: 50px;
                    background: #666 ;
                       left:{{x*50}};
                       top:{{y*50}};                 
                }               
               </style>
                   <template if="{{color}}">
                       <style> #uBlock { background: {{color}}; }  </style>
                   </template>
           </template>
</polymer-element>

<polymer-element name="placed-mine" attributes="x y color portal color" noscript>
           <template>
              <div id="Mine">
                <div> </div> 
                <div> </div> 
              </div>
               <style>
               div#Mine {
                position: fixed;
                    width: 50px;
                    height: 50px;
                    border-color: #444 !important;
                       left:{{x*50}};
                       top:{{y*50}};   
               } 
                #Mine div::after, #Mine div::before {
                    content: '';
                    position: absolute;
                    background: red;
                    width: 4px;
                    border-radius: 50%;
                    height: 4px;
                    margin-left: 4px;
                    margin-top: 8px;
                   }
                   #Mine div:last-child::after {  margin-left:12px;   }
                   #Mine div::before { background:blue; margin-left:8px; margin-top:4px;}
                   #Mine div:last-child::before { margin-top:12px;}
                   @-webkit-keyframes defuses {
                        0% {transform:rotate(0deg);}
                       40% {border-color:#444;}
                       50% {
                           transform:rotate(1800deg);
                           box-shadow:0px 0px 50px #f44;
                           border-color:#f44; 
                           border-width:2px;
                           margin:13px;
                       }
                       55% {
                            border-width: 20px;
                            margin: -5px;
                           box-shadow:0px 0px 100px #f44;
                       }
                       75% {
                           border-width: 20px;
                            margin: -5px;
                           opacity:.9;
                       }
                       90% {
                           border-width:2px;
                           margin:13px;
                           opacity:.7;
                       }
                       100% {opacity:0;box-shadow:none;}
                    }
                   
               </style>
           </template>
</polymer-element>
<!-- version history 
0.1  Creating basics: Wall, Key                      15.02.27
0.2  Adding polymer, openable doors                     02.28
0.3  Money and fixing some door bugs                    02.29
0.4  Add checkpoints and death                          03.02
0.6  Add lasers. Ugly and bad workflow, but it works    03.02
0.6a fixing lasers, set Time properly                   03.04
0.7  Add portals. Not yet OOP                           03.04
0.8  Lasers and Portals converted to OOP                03.05
0.9  Add laser particles and animations. Debug added    03.07
0.9a CSS cleaned, focus added.                          03.07
0.10 Starting walls, pain in the ***.                   03.14
-->


 <link rel="import" href="../../polyfome/include_minimalist.html">